---
title: Zsh Shell Integration
description: Setup and customize fzf for Zsh shell with key bindings and fuzzy completion
---

This guide covers Zsh-specific setup and customization for fzf shell integration.

## Quick Setup

Add the following line to your `~/.zshrc`:

```zsh ~/.zshrc
# Set up fzf key bindings and fuzzy completion
source <(fzf --zsh)
```

Then reload your shell configuration:

```zsh
source ~/.zshrc
```

<Note>
The `--zsh` option requires fzf 0.48.0 or later. For older versions, see [Manual Setup](#manual-setup) below.
</Note>

## What Gets Enabled

Running `source <(fzf --zsh)` enables:

<CardGroup cols={2}>
  <Card title="Key Bindings" icon="keyboard">
    - **CTRL-T**: Paste files/directories
    - **CTRL-R**: Search command history
    - **ALT-C**: Navigate to directory
  </Card>
  <Card title="Fuzzy Completion" icon="terminal">
    - `**<TAB>` trigger for fuzzy completion
    - Works with files, directories, PIDs, hosts
    - Automatic function detection
  </Card>
</CardGroup>

## Manual Setup (for fzf < 0.48.0)

If you have an older version of fzf, source the shell scripts directly:

```zsh ~/.zshrc
# Key bindings
source /usr/share/doc/fzf/examples/key-bindings.zsh

# Fuzzy completion
source /usr/share/doc/fzf/examples/completion.zsh
```

<Note>
The location of these files varies by installation method. Common paths:
- **Debian/Ubuntu**: `/usr/share/doc/fzf/examples/`
- **Arch Linux**: `/usr/share/fzf/`
- **Homebrew**: `/opt/homebrew/opt/fzf/shell/` (Apple Silicon) or `/usr/local/opt/fzf/shell/` (Intel)
- **Git install**: `~/.fzf/shell/`

Use `apt show fzf` or your package manager to find the correct location.
</Note>

## Configuration

### Key Bindings

Customize key binding behavior with environment variables:

```zsh ~/.zshrc
# Preview file content using bat
export FZF_CTRL_T_OPTS="
  --walker-skip .git,node_modules,target
  --preview 'bat -n --color=always {}'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'"

# CTRL-Y to copy the command into clipboard
export FZF_CTRL_R_OPTS="
  --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort'
  --color header:italic
  --header 'Press CTRL-Y to copy command into clipboard'"

# Print tree structure in the preview window
export FZF_ALT_C_OPTS="
  --walker-skip .git,node_modules,target
  --preview 'tree -C {}'"

# Set up fzf key bindings and fuzzy completion
source <(fzf --zsh)
```

<Warning>
Environment variables must be set **before** the `source <(fzf --zsh)` line.
</Warning>

### Fuzzy Completion

Customize fuzzy completion behavior:

```zsh ~/.zshrc
# Change trigger sequence from ** to ~~
export FZF_COMPLETION_TRIGGER='~~'

# General completion options
export FZF_COMPLETION_OPTS='--border --info=inline'

# Path completion options (e.g., vim **<TAB>)
export FZF_COMPLETION_PATH_OPTS='--walker file,dir,follow,hidden'

# Directory completion options (e.g., cd **<TAB>)
export FZF_COMPLETION_DIR_OPTS='--walker dir,follow'

source <(fzf --zsh)
```

## Advanced Customization

### Custom Source Commands

Override the default file traversal commands:

```zsh ~/.zshrc
# Use fd for CTRL-T
export FZF_CTRL_T_COMMAND='fd --type f --strip-cwd-prefix --hidden --follow --exclude .git'

# Use fd for ALT-C
export FZF_ALT_C_COMMAND='fd --type d --hidden --follow --exclude .git'

# Use fd for completion
_fzf_compgen_path() {
  fd --hidden --follow --exclude ".git" . "$1"
}

_fzf_compgen_dir() {
  fd --type d --hidden --follow --exclude ".git" . "$1"
}

source <(fzf --zsh)
```

### Command-Specific Completion

Customize fzf options based on the command being completed:

```zsh ~/.zshrc
source <(fzf --zsh)

# Must be defined AFTER fzf initialization
_fzf_comprun() {
  local command=$1
  shift

  case "$command" in
    cd)           fzf --preview 'tree -C {} | head -200'   "$@" ;;
    export|unset) fzf --preview "eval 'echo \$'{}"
         "$@" ;;
    ssh)          fzf --preview 'dig {}'                   "$@" ;;
    *)            fzf --preview 'bat -n --color=always {}' "$@" ;;
  esac
}
```

### Custom Command Completion

Zsh automatically detects completion functions by name. Just define `_fzf_complete_COMMAND`:

```zsh ~/.zshrc
source <(fzf --zsh)

# Custom completion for 'myapp'
_fzf_complete_myapp() {
  _fzf_complete --multi --reverse --prompt="myapp> " -- "$@" < <(
    myapp --list-all
  )
}

# With post-processing
_fzf_complete_myapp_post() {
  awk '{print $1}'
}

# No need to manually register in Zsh - it's automatic!
```

## Zsh-Specific Features

### Automatic Function Detection

Unlike Bash, Zsh automatically picks up `_fzf_complete_*` functions without manual registration:

```zsh
# Define the function
_fzf_complete_git() {
  _fzf_complete --reverse --multi -- "$@" < <(
    git branch --all --format='%(refname:short)'
  )
}

# It just works - no 'complete' command needed!
```

### Widget System

Zsh uses the Zsh Line Editor (ZLE) widget system for key bindings:

```zsh
# View fzf widgets
zle -la | grep fzf
```

You'll see:
- `fzf-file-widget` (CTRL-T)
- `fzf-cd-widget` (ALT-C)
- `fzf-history-widget` (CTRL-R)

### Option Preservation

The fzf Zsh integration preserves your shell options using `emulate zsh` and restores them after initialization.

## Disabling Features

Disable specific key bindings by setting their `*_COMMAND` variable to empty:

```zsh ~/.zshrc
# Disable CTRL-R and ALT-C, keep only CTRL-T
FZF_CTRL_R_COMMAND= FZF_ALT_C_COMMAND= source <(fzf --zsh)
```

## Complete Configuration Example

Here's a comprehensive `~/.zshrc` configuration:

```zsh ~/.zshrc
# ============================================================================
# fzf Configuration
# ============================================================================

# General fzf options
export FZF_DEFAULT_OPTS="
  --height 40%
  --layout reverse
  --border
  --inline-info
  --color 'fg:#bbccdd,fg+:#ddeeff,bg:#334455,preview-bg:#223344,border:#778899'"

# Use fd instead of find
export FZF_DEFAULT_COMMAND='fd --type f --strip-cwd-prefix --hidden --follow --exclude .git'

# CTRL-T configuration
export FZF_CTRL_T_COMMAND="$FZF_DEFAULT_COMMAND"
export FZF_CTRL_T_OPTS="
  --walker-skip .git,node_modules,target,dist,build
  --preview 'bat -n --color=always --line-range :500 {}'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'
  --bind 'ctrl-y:execute-silent(echo -n {} | pbcopy)'
  --header 'CTRL-/: toggle preview | CTRL-Y: copy path'"

# CTRL-R configuration
export FZF_CTRL_R_OPTS="
  --preview 'echo {}'
  --preview-window up:3:hidden:wrap
  --bind 'ctrl-/:toggle-preview'
  --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort'
  --color header:italic
  --header 'Press CTRL-Y to copy command | CTRL-/: toggle preview'"

# ALT-C configuration
export FZF_ALT_C_COMMAND='fd --type d --hidden --follow --exclude .git'
export FZF_ALT_C_OPTS="
  --preview 'tree -C {} | head -200'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'"

# Completion configuration
export FZF_COMPLETION_TRIGGER='**'
export FZF_COMPLETION_OPTS='--border --info=inline'
export FZF_COMPLETION_PATH_OPTS="
  --walker file,dir,follow,hidden
  --walker-skip .git,node_modules"
export FZF_COMPLETION_DIR_OPTS='--walker dir,follow,hidden'

# Initialize fzf
source <(fzf --zsh)

# Custom completion source commands
_fzf_compgen_path() {
  fd --hidden --follow --exclude ".git" . "$1"
}

_fzf_compgen_dir() {
  fd --type d --hidden --follow --exclude ".git" . "$1"
}

# Command-specific fzf options
_fzf_comprun() {
  local command=$1
  shift

  case "$command" in
    cd)           fzf --preview 'tree -C {} | head -200' "$@" ;;
    export|unset) fzf --preview "eval 'echo \$'{}" "$@" ;;
    ssh)          fzf --preview 'dig {}' "$@" ;;
    vim|nvim)     fzf --preview 'bat -n --color=always {}' "$@" ;;
    *)            fzf "$@" ;;
  esac
}

# Custom git completion
_fzf_complete_git() {
  _fzf_complete --reverse --multi -- "$@" < <(
    git branch --all --format='%(refname:short)'
  )
}

# Custom kubectl completion
_fzf_complete_kubectl() {
  local -a args
  args=("$@")
  
  if [[ "${args[2]}" == "get" ]]; then
    _fzf_complete --multi --reverse -- "$@" < <(
      kubectl get "${args[3]:-pods}" -o name 2>/dev/null | sed 's|^.*/||'
    )
  fi
}
```

## Integration with Oh My Zsh

If you use Oh My Zsh, you can use the fzf plugin or configure manually:

### Using the Oh My Zsh Plugin

```zsh ~/.zshrc
# Add to plugins array
plugins=(... fzf)
```

### Manual Configuration with Oh My Zsh

```zsh ~/.zshrc
# Place BEFORE 'source $ZSH/oh-my-zsh.sh'
export FZF_CTRL_T_OPTS="..."
export FZF_CTRL_R_OPTS="..."
export FZF_ALT_C_OPTS="..."

# Source Oh My Zsh
source $ZSH/oh-my-zsh.sh

# Place AFTER Oh My Zsh
source <(fzf --zsh)

# Custom functions go here
_fzf_comprun() { ... }
```

## Integration with zinit/zplug/antibody

For Zsh plugin managers:

<Tabs>
  <Tab title="zinit">
    ```zsh ~/.zshrc
    # Set options before loading
    export FZF_DEFAULT_OPTS="..."
    
    zinit ice lucid wait
    zinit light junegunn/fzf
    
    # Or manually
    source <(fzf --zsh)
    ```
  </Tab>
  
  <Tab title="zplug">
    ```zsh ~/.zshrc
    # Set options before loading
    export FZF_DEFAULT_OPTS="..."
    
    zplug "junegunn/fzf", use:"shell/*.zsh", defer:2
    
    # Or manually
    source <(fzf --zsh)
    ```
  </Tab>
  
  <Tab title="antibody">
    ```zsh ~/.zshrc
    # Set options before loading
    export FZF_DEFAULT_OPTS="..."
    
    antibody bundle junegunn/fzf
    
    # Or manually
    source <(fzf --zsh)
    ```
  </Tab>
</Tabs>

## Troubleshooting

<AccordionGroup>
  <Accordion title="Key bindings not working">
    1. Verify fzf is in your PATH: `which fzf`
    2. Check if widgets are loaded: `zle -la | grep fzf`
    3. Ensure you've reloaded your shell: `source ~/.zshrc`
    4. Check for conflicts with other plugins (especially Oh My Zsh plugins)
  </Accordion>

  <Accordion title="Completion not triggering">
    1. Check the trigger sequence: `echo $FZF_COMPLETION_TRIGGER`
    2. Ensure you're typing the trigger correctly: `**<TAB>`
    3. Verify completion functions exist: `functions | grep _fzf`
    4. Try `compinit` to rebuild completion cache
  </Accordion>

  <Accordion title="Conflicts with Oh My Zsh">
    1. Load fzf AFTER Oh My Zsh initialization
    2. Check for conflicting plugins (vi-mode, history plugins)
    3. Try disabling the Oh My Zsh fzf plugin if using manual setup
    4. Ensure environment variables are set before Oh My Zsh loads
  </Accordion>

  <Accordion title="Slow performance">
    1. Use faster file listing tools like `fd` instead of `find`
    2. Add exclusions with `--walker-skip` or `--exclude`
    3. Limit depth with `fd --max-depth`
    4. Check for slow completion functions in your config
  </Accordion>
</AccordionGroup>

## Zsh-Specific Tips

### Globbing Integration

Zsh's globbing works alongside fzf completion:

```zsh
# Use Zsh glob for simple cases
vim **/*.md<TAB>  # Zsh native glob completion

# Use fzf for fuzzy matching
vim **<TAB>       # fzf fuzzy completion
```

### History Options

Zsh history options affect CTRL-R behavior:

```zsh ~/.zshrc
# Recommended history settings
setopt EXTENDED_HISTORY          # Write timestamp to history
setopt HIST_EXPIRE_DUPS_FIRST    # Expire duplicates first
setopt HIST_IGNORE_DUPS          # Don't record duplicates
setopt HIST_IGNORE_SPACE         # Don't record commands starting with space
setopt HIST_VERIFY               # Show command before running from history
setopt SHARE_HISTORY             # Share history between sessions
```

### Custom Keybindings

Add custom keybindings using ZLE:

```zsh ~/.zshrc
source <(fzf --zsh)

# Custom binding: CTRL-G for git files
fzf-git-widget() {
  local selected
  selected=$(git ls-files | fzf --preview 'bat --color=always {}')
  LBUFFER="$LBUFFER$selected"
  zle reset-prompt
}
zle -N fzf-git-widget
bindkey '^G' fzf-git-widget
```

## See Also

- [Key Bindings](/shell/key-bindings) - Detailed key binding documentation
- [Fuzzy Completion](/shell/fuzzy-completion) - Complete completion guide
- [Bash Configuration](/shell/bash) - For Bash users
- [Shell Integration Overview](/shell/overview) - General concepts